<!DOCTYPE html>
<html>

<head>
    <title>Week 11 In Class</title>
    <script>
        //=============================================
        // Functions

        var afun = function (input_parameter) {
            return input_parameter;
        }
        //test the function
        console.log(afun("this is my input parameter"));

        //same thing but with arrow function
        var afun2 = input_parameter => input_parameter;

        //test arrow function
        console.log(afun2("my second input parameter"));

        //pass more than one input parameter
        var afun3 = (a, b, c) => a + b + c;
        console.log(afun3(1, 2, 3));

        //lets use an arrow function inside an object method
        var student = {
            name: "test student name",
            courses: ['web prog', 'java', 'c++', 'etc.'],
            printCourseInformation() {
                //iterate courses array and print its contents
                this.courses.forEach(course => {
                    //print item into the console.
                    console.log("course: ", course);
                });
            }
        };

        //test printcourseinformation method
        student.printCourseInformation();


        //======================================
        //promises
        const delay = input_seconds => {
            return new Promise(resolve => {
                setTimeout(resolve, input_seconds * 1000)
            });
        };

        //test delay
        delay(2).then(
            () => console.log('i have returned after: 2 seconds!')
        );
        delay(4).then(
            () => console.log('i have returned after: 4 seconds!')
        );

        console.log('we have executed delay x time!');


        //promise with resolve (pass) and reject (failed)
        const delay2 = seconds => {
            return new Promise((resolve, reject) => {
                if (typeof seconds !== "number") {
                    reject(new Error("input parameter seconds must be numeric"))
                }
                setTimeout(
                    () => resolve(`${seconds} second/s delay is up`), seconds * 1000
                );
            });
        };


        //test delay 2
        delay2(4).then(msg => msg.toUpperCase())
            .then(msg => `${msg}!!!!`)
            .then(msg => console.log(msg))

        //test delay 2 reject
        delay2("4 seconds").then(msg => msg.toUpperCase())
            .then(msg => `${msg}!!!!`)
            .then(msg => console.log(msg))

        //Lets find out how many people (at least from NASA) are out in the space
        const peopleInSpace = () => {
            return new Promise((resolve, reject) => {
                const url = 'http://api.open-notify.org/astros.json';
                const request = new XMLHttpRequest();
                request.open('GET', url);
                request.onload = () => {
                    if (request.status === 200) {
                        resolve(JSON.parse(request.response))
                    }
                    else {
                        rejects(Error(request.statusText));
                    }
                };
                request.onerror = err => rejects(err);
                request.send();
            });
        };

        //use people in space object
        peopleInSpace().then(
            data => console.log(data),
            err => console.error(new Error("unable to get people in space"))
        );

    </script>

    <style>

    </style>
</head>

<body>

</body>

</html>